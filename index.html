<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal VR Interactivo</title>
    <!-- Cargamos A-Frame para la realidad virtual -->
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <!-- Extensión para eventos de estado y animaciones más complejas -->
    <script src="https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; }
        #loading-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: black;
            display: flex; justify-content: center; align-items: center;
            color: white; font-family: sans-serif; z-index: 9999;
            pointer-events: none; opacity: 0; transition: opacity 0.5s;
        }
    </style>
</head>
<body>

    <div id="loading-overlay">Cargando experiencia...</div>

    <a-scene shadow="type: pcfsoft" background="color: #050505">
        
        <!-- ASSETS: Definimos recursos como texturas e iconos -->
        <a-assets>
            <img id="grid" src="https://img.gs/bb6197/grid.png" crossorigin="anonymous">
            <img id="sky" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/sechelt.jpg" crossorigin="anonymous">
            <!-- Placeholders para iconos de programas -->
            <img id="icon-media" src="https://img.icons8.com/fluency/96/video-conference.png" crossorigin="anonymous">
            <img id="icon-games" src="https://img.icons8.com/fluency/96/controller.png" crossorigin="anonymous">
            <img id="icon-web" src="https://img.icons8.com/fluency/96/globe.png" crossorigin="anonymous">
            <img id="icon-settings" src="https://img.icons8.com/fluency/96/settings.png" crossorigin="anonymous">
        </a-assets>

        <!-- CÁMARA Y CURSOR (SISTEMA DE MIRADA) -->
        <a-entity id="rig" position="0 1.6 4">
            <a-camera id="camera" look-controls wasd-controls>
                <!-- El cursor es el punto central. "Fuse" permite activarlo por tiempo de mirada -->
                <a-cursor
                    id="cursor"
                    animation__click="property: scale; startEvents: click; easing: easeInCubic; dur: 150; from: 0.1 0.1 0.1; to: 1 1 1"
                    animation__fusing="property: scale; startEvents: fusing; easing: easeInCubic; dur: 5000; from: 1 1 1; to: 0.1 0.1 0.1"
                    animation__mouseleave="property: scale; startEvents: mouseleave; easing: easeInCubic; dur: 500; to: 1 1 1"
                    cursor="fuse: true; fuseTimeout: 5000"
                    material="color: #00f2ff; shader: flat"
                    geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03">
                </a-cursor>
            </a-camera>
        </a-entity>

        <!-- ESCENARIO INICIAL -->
        <a-entity id="lobby">
            <!-- Suelo estilo rejilla Tron -->
            <a-plane position="0 0 0" rotation="-90 0 0" width="100" height="100" 
                     material="src: #grid; repeat: 100 100; transparent: true; opacity: 0.5; color: #00f2ff"></a-plane>
            
            <a-sky material="shader: gradient; topColor: #050505; bottomColor: #1a1a2e"></a-sky>

            <!-- EL BOTÓN DE INGRESO -->
            <a-entity id="entry-button-container" position="0 1.6 -3">
                <!-- Texto de instrucción -->
                <a-text value="MIRA EL BOTON PARA ENTRAR\n(5 SEGUNDOS)" align="center" position="0 0.8 0" scale="0.8 0.8 0.8" color="#fff"></a-text>
                
                <!-- El botón físico -->
                <a-entity id="main-button" 
                          geometry="primitive: box; width: 1.5; height: 0.6; depth: 0.2" 
                          material="color: #00f2ff; emissive: #00f2ff; emissiveIntensity: 0.5"
                          class="interactive"
                          event-set__mouseenter="_target: #button-text; color: #fff"
                          event-set__mouseleave="_target: #button-text; color: #000">
                    <a-text id="button-text" value="INGRESAR" align="center" position="0 0 0.11" color="#000" font="mozillavr"></a-text>
                </a-entity>

                <!-- Aro de carga visual que rodea al botón -->
                <a-ring color="#00f2ff" radius-inner="0.9" radius-outer="1.0" position="0 0 -0.1" opacity="0.3">
                    <a-ring color="#fff" radius-inner="0.9" radius-outer="1.0" theta-length="0" id="loading-ring">
                        <a-animation attribute="theta-length" dur="5000" from="0" to="360" begin="startLoading"></a-animation>
                    </a-ring>
                </a-ring>
            </a-entity>
        </a-entity>

        <!-- PANTALLA FLOTANTE (Oculta al inicio) -->
        <a-entity id="dashboard" position="0 1.6 -2" visible="false" scale="0.01 0.01 0.01">
            <!-- Fondo de la pantalla -->
            <a-plane width="4" height="2.5" material="color: #111; opacity: 0.9; transparent: true; shader: flat" position="0 0 -0.1"></a-plane>
            <a-text value="MENU DE PROGRAMAS" position="0 1 0.01" align="center" color="#00f2ff"></a-text>

            <!-- Grid de Programas (Iconos) -->
            <a-entity position="-1.2 0.2 0.01">
                <!-- Programa 1 -->
                <a-entity class="app-icon" position="0 0 0">
                    <a-plane width="0.6" height="0.6" material="src: #icon-media; transparent: true"></a-plane>
                    <a-text value="Cine VR" align="center" position="0 -0.4 0" scale="0.4 0.4 0.4"></a-text>
                </a-entity>
                <!-- Programa 2 -->
                <a-entity class="app-icon" position="0.8 0 0">
                    <a-plane width="0.6" height="0.6" material="src: #icon-games; transparent: true"></a-plane>
                    <a-text value="Juegos" align="center" position="0 -0.4 0" scale="0.4 0.4 0.4"></a-text>
                </a-entity>
                <!-- Programa 3 -->
                <a-entity class="app-icon" position="1.6 0 0">
                    <a-plane width="0.6" height="0.6" material="src: #icon-web; transparent: true"></a-plane>
                    <a-text value="Navegador" align="center" position="0 -0.4 0" scale="0.4 0.4 0.4"></a-text>
                </a-entity>
                <!-- Programa 4 -->
                <a-entity class="app-icon" position="2.4 0 0">
                    <a-plane width="0.6" height="0.6" material="src: #icon-settings; transparent: true"></a-plane>
                    <a-text value="Ajustes" align="center" position="0 -0.4 0" scale="0.4 0.4 0.4"></a-text>
                </a-entity>
            </a-entity>

            <!-- Botón para volver (para demo) -->
            <a-entity id="back-button" position="0 -0.9 0.05" geometry="primitive: plane; width: 0.8; height: 0.2" material="color: #ff4757">
                <a-text value="CERRAR SESION" align="center" scale="0.3 0.3 0.3"></a-text>
            </a-entity>
        </a-entity>

    </a-scene>

    <script>
        const mainButton = document.querySelector('#main-button');
        const lobby = document.querySelector('#lobby');
        const dashboard = document.querySelector('#dashboard');
        const cursor = document.querySelector('#cursor');
        const loadingRing = document.querySelector('#loading-ring');

        // Lógica de detección de mirada
        mainButton.addEventListener('fusing', () => {
            console.log('Cargando sensor...');
            // Podríamos añadir un feedback visual aquí si quisiéramos
        });

        // Cuando se completa el tiempo de fuse (5 segundos)
        mainButton.addEventListener('click', () => {
            abrirDashboard();
        });

        function abrirDashboard() {
            // Animación de desaparición del lobby
            lobby.setAttribute('animation', 'property: scale; to: 0 0 0; dur: 1000; easing: easeInBack');
            
            setTimeout(() => {
                lobby.setAttribute('visible', 'false');
                
                // Mostrar Dashboard
                dashboard.setAttribute('visible', 'true');
                dashboard.setAttribute('animation', 'property: scale; from: 0.01 0.01 0.01; to: 1 1 1; dur: 800; easing: easeOutElastic');
                
                // Cambiar el cielo para dar sensación de cambio de espacio
                document.querySelector('a-sky').setAttribute('material', 'src: #sky; topColor: white; bottomColor: white');
            }, 1000);
        }

        // Lógica para el botón de regreso
        document.querySelector('#back-button').addEventListener('click', () => {
            location.reload(); // Reiniciar la experiencia
        });

        // Prevenir problemas de interacción en móviles
        window.addEventListener('click', function () {
            const scene = document.querySelector('a-scene');
            if (scene.hasLoaded) {
                // Forzar el modo VR si es necesario o manejar audio
            }
        });
    </script>
</body>
</html>







